```python
RNN(Recurrent Neural Network) : 기존의 신경망은 입력된 데이터의 길이가 정해졌으나
    다양한 길이의 입력 시퀀스가 생겨나서 구현한 신경망 (자연어 처리, 스팸처리, (좋아요, 싫어요), 번역시스템)
    
    ex) 움직이는 객체의 경로를 저장해서 판별하는 것, 사람의 동작을 포함하는 것은 RNN이 가진다
CNN / RNN -> GAN(생성모델) : 모션작곡, 자율주행, 홈트 등등
        
 - 입력과 출력을 시퀀스 단위로 처리하는 모델 < 번역 > 입력된 문장(단어)  -> 출력된 문장(단어)
 - 순환 신경망(RNN) 과 재귀 신경망과는 완전 다른 개념의 모델이다.
 - 노드 셀을 만들어서 입력과 출력 사이에서 순환 할 수 있도록 구현된다.
   Xt -> Cell(메모리 샐, RNN 셀) -> Yt
 - 메모리 셀은 각각의 시점 (t) 을 가지고 바로 이전의 입력한 시점에서 전달해온 데이터를 가지고 재귀적인 활동을 
   한다. t+1 -> Cell
 - t 시점에서 메모리 셀은 t-1 시점의 메모리 셀이 보낸 은닉상태의 값을 t 시점의 은닉상태 계싼을 위한
    입력값이다.
    ex) '나는 금요일이 좋다'
      Xt -> Cell(메모리 셀, RNN 셀) -> Yt
    
 - 일 대 다 : 입력 하나 -> 셀 많이 -> 출력 많이  ex) 사진하나 -> 여러개의 제목(사진 제목이 단어 시퀀스 출력) -> 
 - 다 대 일 : 입력 많이 -> 셀 많이 -> 출력 하나  ex) 감성분류, 스팸분류
 - 다 대 다 : 입력 많이 -> 셀 많이 -> 출력 많이  ex) 번역처리 
 
 - RNN의 은닉층 연산은 행렬 연산
ex) model.add(SinpleRNN(hidden_size), input_shape = ())

    
    
    
```


```python
# ex) RNN 층을 만들어 보자
from keras.models import *
from keras.layers import *

model = Sequential()
# model.add(SimpleRNN(3, input_shape = (2,10), return_sequences = True)) #(None, 2, 3)
model.add(SimpleRNN(3, batch_input_shape = (8, 2, 10), return_sequences = True)) #(8, 2, 3)
model.summary()


```

    Model: "sequential_6"
    _________________________________________________________________
    Layer (type)                 Output Shape              Param #   
    =================================================================
    simple_rnn_5 (SimpleRNN)     (8, 2, 3)                 42        
    =================================================================
    Total params: 42
    Trainable params: 42
    Non-trainable params: 0
    _________________________________________________________________
    

![image.png](attachment:image.png)


```python
 - 일련의 순서 신경망 '단어 4개 = 4개의 신경망'
  -t 시점에서 메모리  셀은 t-1 시점의 메모리 셀이 보낸 은닉상태의 값을 t 시점의 은닉상태 계산을 위한
   입력값이다.
    
  - x(1)은 one-hot 연산을 구현한다.
  - s(t) : 네트웍에서 기억하는 공간
        St = f(Uxt + Wst - 1) 이때 함수로 비선형 함수가 된다.
  - Ot = t의 출력값 (문장에 출현 예측)  
  - Ot = softmax(Vst)  
  - LSTM(Long Short Term Memory) : 장단기 메모리로 은닉층의 메모리 셀에 입력게이트, 소멸 게이트, 출력게이트를
    추가해서 불필요한 기억은 지우고 기억해야 되는 내용들을 저장한다. 각각의 게이트에는 시그모이드 함수가 존재한다.
    시그모이드 함수를 지나면 0, 1 값이 나오게 되는데 이 값들을 가지고 게이트가 조절된다.
    
    
    
```


```python
import tensorflow as tf
import numpy as np
# RNN은 텐서를 받을 때 3D 텐서를 받는다.

inputs = np.random.random([32,10,8]).astype(np.float32)
simple_rnn = tf.keras.layers.SimpleRNN(4)
#print(inputs)
print(type(simple_rnn(inputs)))

output = simple_rnn(inputs) # The output has shape '[32, 4]' 
print(output)

#return_sequences 히든레이어를 확인 시켜준다.
simple_rnn = tf.keras.layers.SimpleRNN(4, return_sequences = True, return_state = True)
print(simple_rnn)

# whole_sequence_outpue has shape '[32, 10, 4]'
# final_state has shape '[32, 4]'
whole_sequence_output, final_state = simple_rnn(inputs)
print(whole_sequence_output)
print(final_state)

```

    <class 'tensorflow.python.framework.ops.EagerTensor'>
    tf.Tensor(
    [[-0.02848039  0.04977937 -0.81184745 -0.00218922]
     [ 0.53956     0.29721788  0.09577876 -0.35174227]
     [-0.36988148 -0.27995396 -0.8592404   0.58186215]
     [ 0.29835624 -0.46448234 -0.08611089 -0.27102754]
     [ 0.18962294  0.09736499 -0.35036266 -0.29030982]
     [-0.42342144  0.3117994  -0.43266028 -0.31106856]
     [ 0.16755435 -0.42122662 -0.25736848 -0.48727486]
     [-0.15554866 -0.00688356 -0.2371837   0.62482774]
     [ 0.0457964   0.04119242  0.02429275 -0.77138174]
     [ 0.5135367  -0.50422394 -0.5816498   0.8689028 ]
     [ 0.35323998  0.12586963 -0.47522295  0.4817884 ]
     [-0.6154927   0.6918485  -0.56572205  0.32892075]
     [-0.21949212 -0.38999954 -0.80448323 -0.25445944]
     [ 0.14784786  0.32212657 -0.23213251  0.434497  ]
     [ 0.3849803   0.48019087 -0.08685499 -0.6488707 ]
     [-0.1085138  -0.0457969   0.24893014 -0.6086857 ]
     [-0.2270757  -0.00414904 -0.4089047  -0.05592685]
     [-0.19805875 -0.6410461   0.33216387  0.4061735 ]
     [-0.20883459 -0.581812    0.2526754   0.06348144]
     [-0.08197819  0.44286364 -0.25656718 -0.8042619 ]
     [-0.48974183  0.10991809  0.5720422  -0.3518585 ]
     [ 0.08974756 -0.5714967  -0.55492204  0.13632986]
     [ 0.58491886 -0.7959652  -0.04227822  0.62965846]
     [-0.02274076  0.02081993 -0.786993    0.7040839 ]
     [ 0.27940726 -0.45341873 -0.8869187  -0.0043076 ]
     [-0.3442846  -0.36741957  0.13213405 -0.6882495 ]
     [-0.15694222  0.53244996 -0.47225878 -0.60280794]
     [-0.22397125  0.10533508 -0.4550318  -0.6937596 ]
     [ 0.01268778  0.44774848 -0.8539037   0.21981698]
     [-0.01613016 -0.7103951   0.19615872  0.33189547]
     [ 0.33263785 -0.7649071  -0.6790187   0.72793067]
     [-0.15231813  0.1354274   0.22893661 -0.50438344]], shape=(32, 4), dtype=float32)
    <tensorflow.python.keras.layers.recurrent.SimpleRNN object at 0x000001A7662CB4C0>
    tf.Tensor(
    [[[ 0.8194682   0.21489161  0.548974    0.45562854]
      [ 0.4175294  -0.21321304  0.7851644   0.685153  ]
      [ 0.29270905 -0.79780334  0.73874104  0.3163429 ]
      ...
      [-0.05275898 -0.38647956  0.85336405  0.52779365]
      [ 0.84808314 -0.4025346   0.24912718  0.8580474 ]
      [ 0.39498752  0.03321167  0.90275717  0.7938248 ]]
    
     [[ 0.29259443 -0.72949415 -0.20412447  0.62893933]
      [ 0.44662505  0.4977987   0.69390076  0.3605783 ]
      [-0.08663292 -0.84582496  0.6505577   0.44897693]
      ...
      [ 0.5456134   0.23606363  0.8891136   0.8996316 ]
      [ 0.11497823 -0.45963442  0.8268354   0.2897015 ]
      [-0.031563   -0.7350365   0.81385046  0.6033888 ]]
    
     [[ 0.19942118  0.2275961  -0.3486559   0.6601489 ]
      [ 0.6106858  -0.4726449   0.6025395  -0.12655053]
      [-0.28897586 -0.37982252  0.67682534  0.8052476 ]
      ...
      [ 0.6034572   0.08027355  0.16912007  0.9320298 ]
      [ 0.33486998 -0.06135476  0.77473336 -0.5703609 ]
      [-0.33201417 -0.9486594  -0.10572042  0.30544308]]
    
     ...
    
     [[ 0.2918816  -0.3275604   0.14054471  0.15881832]
      [ 0.40988663 -0.07303887  0.28296605  0.4631445 ]
      [ 0.081532   -0.0251384   0.7036427   0.22881888]
      ...
      [ 0.376356    0.25749812  0.73900414  0.7366265 ]
      [ 0.54905206 -0.59449005  0.83954537  0.43021706]
      [-0.3433269  -0.40472016  0.62067825  0.7813414 ]]
    
     [[ 0.52558994 -0.18667401 -0.31517887  0.6732957 ]
      [ 0.28733385  0.12579979  0.36462307 -0.08238497]
      [ 0.4464139  -0.48995054  0.27746215  0.49706146]
      ...
      [ 0.74949956 -0.3337406   0.48144656  0.6303779 ]
      [ 0.40786415  0.3147442   0.54148436  0.7200331 ]
      [ 0.2264315  -0.8767437   0.8288919   0.61448383]]
    
     [[ 0.7332208  -0.24339366  0.2395684   0.517348  ]
      [-0.23404989 -0.20883666  0.50914615  0.3530367 ]
      [ 0.3681075  -0.45279914  0.3688143   0.5052595 ]
      ...
      [ 0.128922    0.01275634  0.66904217  0.26136822]
      [ 0.5442633  -0.7266346   0.7601136   0.5767814 ]
      [ 0.47556522 -0.22523943  0.7423139   0.8477748 ]]], shape=(32, 10, 4), dtype=float32)
    tf.Tensor(
    [[ 0.39498752  0.03321167  0.90275717  0.7938248 ]
     [-0.031563   -0.7350365   0.81385046  0.6033888 ]
     [-0.33201417 -0.9486594  -0.10572042  0.30544308]
     [ 0.36596414 -0.5207711   0.4088778   0.65999013]
     [ 0.83077604 -0.02947318  0.56064     0.8393174 ]
     [-0.06188246 -0.8107378   0.56874305  0.7551412 ]
     [ 0.86029065 -0.45895764  0.41755068  0.6724831 ]
     [ 0.5650929  -0.809608    0.91356915  0.75590616]
     [ 0.29718697 -0.5436019   0.6541896   0.89562804]
     [-0.3452479  -0.7780814   0.66453093  0.15487613]
     [-0.0013853  -0.746786    0.24651256  0.69133615]
     [ 0.00494506 -0.68070656  0.81876576  0.39700553]
     [ 0.79401374 -0.573479    0.35057324  0.6387894 ]
     [ 0.5035889  -0.8300253   0.9010039   0.6065811 ]
     [ 0.6731359  -0.48206615  0.8858043   0.66629064]
     [ 0.6396497  -0.2913832   0.5877101   0.66826254]
     [-0.30341446 -0.65014356  0.7457757   0.7440301 ]
     [ 0.52547723  0.19475639  0.21987347  0.87016934]
     [ 0.5133975  -0.19147828  0.7173009   0.45189705]
     [ 0.7792575  -0.4330891   0.60446787  0.6947666 ]
     [-0.23801604 -0.36077595  0.72894526  0.19981003]
     [ 0.27395073 -0.23700082  0.19089256  0.76116455]
     [ 0.06939471 -0.7300101   0.34958294  0.8283197 ]
     [ 0.05703018 -0.69727427  0.93797994  0.39144608]
     [ 0.3312264  -0.8239317   0.71016246  0.6272635 ]
     [ 0.07410734  0.22658505  0.7720515   0.748724  ]
     [ 0.10853528 -0.13673444  0.88401234  0.39594826]
     [ 0.84148264  0.34924346  0.04500524  0.94384336]
     [ 0.14354755 -0.62600964  0.82176995  0.365945  ]
     [-0.3433269  -0.40472016  0.62067825  0.7813414 ]
     [ 0.2264315  -0.8767437   0.8288919   0.61448383]
     [ 0.47556522 -0.22523943  0.7423139   0.8477748 ]], shape=(32, 4), dtype=float32)
    


```python

```


```python

```
